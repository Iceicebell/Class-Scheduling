<head>
    <link rel="icon" href="{{ url_for('static', filename='img/scheduler_logo.png') }}">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/dep_head/generate_table.css') }}">

    <style>
        #loading {
            display: none;
            text-align: center;
            padding: 20px;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>


{% extends "dep_head/dep_head.html" %}

{% block content %}
<form id="generateForm" method="POST">
    {{ form.hidden_tag() }}
    <div class="coolinput">
        <!-- <label for="input" class="text">Population</label>
        <input type="number" placeholder="Type here..." name="input" class="input"> -->
        
        <!-- <label for="input" class="text">Generations</label>
        <input type="number" placeholder="Type here..." name="input" class="input"> -->
        <button id="generate-button" class="generate">Generate</button>
    </div>
    
</form>
<div id="loading">
    <div class="spinner"></div>
    <p>Generating schedule... This may take a few moments.</p>
</div>
<div id="scheduleResult">
    {% if schedule %}
    {% for section_id, section_data in schedule.items() %}
    <div class="table">
        <div class="table_header">
            <p>Section {{ section_id }}</p>
        </div>
        <div class="table-section">

                <table>
                    <thead>
                        <tr>
                            <th>Course Code/ Block</th>
                            <th>Monday</th>
                            <th>Tuesday</th>
                            <th>Wednesday</th>
                            <th>Thursday</th>
                            <th>Friday</th>
                            <th>Saturday</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Unavailable</td>
                            {% for day in ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'] %}
                                <td>
                                    {% if day in section_data['unavailable'] %}
                                        {% for slot in section_data['unavailable'][day] %}
                                        {{ slot['start_hour'] }}-{{ slot['end_hour'] }}
                                        {% if not loop.last %}<br><br>{% endif %}
                                        {% endfor %}
                                    {% endif %}
                                </td>
                            {% endfor %}
                        </tr>
                    </tbody>
                <tbody>
                    {% for course_code_block, course_schedule in section_data['courses'].items() %}
                    <tr>
                        <td>{{ course_code_block }}</td>
                        {% for day in ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'] %}
                            <td>
                                {% if day in course_schedule %}
                                {{ course_schedule[day]['start_hour'] }}-{{ course_schedule[day]['end_hour'] }}
                                {% endif %}
                            </td>
                        {% endfor %}
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
    
        </div>
    </div>
    {% endfor %}
    {% endif %}
</div>
{% endblock %}
<script src="{{ url_for('static', filename='js/scripts/dep_head/generate.js') }}"></script>